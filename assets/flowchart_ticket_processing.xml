<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" width="900" height="3200" viewBox="0 0 900 3200">
  <defs>
    <style>
      .bg{fill:#f7f9fb}
      .startend{fill:#b7f0c8;stroke:#2e8a44;stroke-width:4}
      .proc{fill:#fff2b8;stroke:#c79020;stroke-width:4}
      .dec{fill:#cfe6ff;stroke:#4a86c5;stroke-width:4}
      .text{font-family: 'Segoe UI', Roboto, Arial; font-size:20px; fill:#1f2937}
      .small{font-size:16px}
      .arrow{stroke:#7a7a7a;stroke-width:4;fill:none;marker-end:url(#arrowhead)}
    </style>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="10" refY="3.5" orient="auto">
      <path d="M0,0 L10,3.5 L0,7 z" fill="#7a7a7a"/>
    </marker>
  </defs>

  <!-- Background -->
  <rect width="100%" height="100%" class="bg" rx="20"/>

  <!-- Start oval -->
  <g transform="translate(150,40)">
    <ellipse cx="300" cy="60" rx="250" ry="60" class="startend"/>
    <text x="300" y="68" text-anchor="middle" class="text">User submits ticket description</text>
  </g>

  <!-- Arrow to first process -->
  <path d="M450 160 L450 220" class="arrow"/>

  <!-- Process 1 -->
  <g transform="translate(100,240)">
    <rect x="50" y="0" width="600" height="120" rx="18" class="proc"/>
    <text x="350" y="70" text-anchor="middle" class="text">Send raw text to LLM for extraction</text>
  </g>

  <!-- Arrow to process 2 -->
  <path d="M450 360 L450 420" class="arrow"/>

  <!-- Process 2 -->
  <g transform="translate(100,420)">
    <rect x="50" y="0" width="600" height="120" rx="18" class="proc"/>
    <text x="350" y="48" text-anchor="middle" class="text small">Extract summary, category, severity</text>
  </g>

  <!-- Arrow to KB search -->
  <path d="M450 540 L450 600" class="arrow"/>

  <!-- KB search -->
  <g transform="translate(100,600)">
    <rect x="50" y="0" width="600" height="120" rx="18" class="proc"/>
    <text x="350" y="68" text-anchor="middle" class="text">Search knowledge base using embedding model</text>
  </g>

  <!-- Arrow to decision -->
  <path d="M450 720 L450 820" class="arrow"/>

  <!-- Decision diamond -->
  <g transform="translate(150,820)">
    <g transform="translate(300,40)">
      <polygon points="0,-70 120,0 0,70 -120,0" class="dec"/>
      <text x="0" y="6" text-anchor="middle" class="text">Is this a known</text>
      <text x="0" y="30" text-anchor="middle" class="text">issue?</text>
    </g>
  </g>

  <!-- Left path (Yes) -->
  <path d="M330 930 L250 1020" class="arrow"/>
  <text x="210" y="980" class="text small">Yes (similarity â‰¥ 0.6)</text>

  <!-- Left classify known -->
  <g transform="translate(40,1020)">
    <rect x="50" y="0" width="300" height="110" rx="14" class="proc"/>
    <text x="200" y="62" text-anchor="middle" class="text">Classify as Known Issue</text>
  </g>

  <!-- Arrow down from known to bottom -->
  <path d="M200 1130 L200 1600" class="arrow"/>
  <text x="200" y="1500" class="text small" text-anchor="middle">Return extracted fields + KB matches</text>

  <!-- Right path (No) -->
  <path d="M570 930 L650 1020" class="arrow"/>
  <text x="690" y="980" class="text small">No (similarity &lt; 0.6)</text>

  <!-- Classify new issue -->
  <g transform="translate(420,1020)">
    <rect x="50" y="0" width="360" height="120" rx="14" class="proc"/>
    <text x="230" y="62" text-anchor="middle" class="text">Classify as New Issue</text>
  </g>

  <!-- Arrow down to send to LLM -->
  <path d="M600 1140 L600 1260" class="arrow"/>
  <text x="600" y="1200" class="text small" text-anchor="middle">Forward to</text>

  <!-- Send to LLM next action -->
  <g transform="translate(320,1260)">
    <rect x="50" y="0" width="450" height="120" rx="18" class="proc"/>
    <text x="275" y="62" text-anchor="middle" class="text">Send to LLM for next-action generation</text>
  </g>

  <!-- Arrow down to generate action -->
  <path d="M450 1380 L450 1500" class="arrow"/>

  <!-- Generate context-aware next action -->
  <g transform="translate(150,1500)">
    <rect x="50" y="0" width="600" height="120" rx="18" class="proc"/>
    <text x="350" y="62" text-anchor="middle" class="text">Generate context-aware next action</text>
  </g>

  <!-- Arrow down to return -->
  <path d="M450 1620 L450 1700" class="arrow"/>
  <text x="610" y="1680" class="text small">Return extracted fields + next action</text>

  <!-- Bottom Display results -->
  <g transform="translate(150,1700)">
    <ellipse cx="300" cy="240" rx="250" ry="60" class="startend"/>
    <text x="300" y="248" text-anchor="middle" class="text">Display results on website</text>
  </g>

  <!-- Connector arrow from known branch to bottom -->
  <path d="M200 1600 L200 1760 L300 1760" class="arrow"/>

</svg>
